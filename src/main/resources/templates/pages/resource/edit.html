<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<!--<![endif]-->
<head>
	<meta charset="utf-8" />
	<meta th:include="pages/layout/title :: title"></meta>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	
	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
	<link href="../assets/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
	<link href="../assets/plugins/font-awesome/5.3/css/all.min.css" rel="stylesheet" />
	<link href="../assets/plugins/ionicons/css/ionicons.min.css" rel="stylesheet" />
	<link href="../assets/plugins/animate/animate.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/style.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/style-responsive.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/theme/default.css" rel="stylesheet" id="theme" />
	<!-- ================== END BASE CSS STYLE ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL STYLE ================== -->
	<link href="../assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.css" rel="stylesheet" />
	<link href="../assets/plugins/ionRangeSlider/css/ion.rangeSlider.css" rel="stylesheet" />
	<link href="../assets/plugins/ionRangeSlider/css/ion.rangeSlider.skinNice.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/password-indicator/css/password-indicator.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-combobox/css/bootstrap-combobox.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-tag-it/css/jquery.tagit.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet" />
	<link href="../assets/plugins/select2/dist/css/select2.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-eonasdan-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-colorpalette/css/bootstrap-colorpalette.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker-fontawesome.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker-glyphicons.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../assets/plugins/pace/pace.min.js"></script>
	<!-- ================== END BASE JS ================== -->
	<style type="text/css">
		.dataTables_filter{
			text-align: right;
		}
		.hand{
			cursor: pointer;
		}
		.cssCheckboxAll{
			margin-top: -24px;
		}
		
		.cssTabCheckBox{
			margin-top: -6px;
		}
		
		.select2-container .select2-selection--single, .select2-container--default .select2-selection--multiple {
		    min-height: 34px!important;
		    border-color: #4CD964!important;
		    outline: 0!important;
		}
		
		.tagit-choice > i {
			margin-top: 7px;
		}
		
		.modal{
			top:20%;
		}
		
		.account-body{
			padding: 15px 30px 15px 30px;
		}
		
		.tagit.ui-widget {
		    padding: 3px 6px 2px!important;
		    margin-bottom: 0!important;
		}
		
		.hideDiv{
			display: none;
		}
	</style>
</head>
<body>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show"><span class="spinner"></span></div>
	<!-- end #page-loader -->
	
	<!-- begin #page-container -->
	<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
		<!-- begin #header -->
		<div th:include="pages/layout/head :: head"></div>
		<!-- end #header -->
		
		<!-- 左侧菜单 -->
		<div th:include="pages/layout/left :: left('resource','resource')"></div>
		
		<!-- begin #content -->
		<div id="content" class="content">
			<form id="resForm" method="post" th:object="${resource}" th:action="*{id eq 0 ? '/resource/insert' : '/resource/update'}" autocomplete="off">
			<!-- begin breadcrumb -->
			<ol class="breadcrumb pull-right">
				<li class="breadcrumb-item"><a href="javascript:;" th:onclick="'location.href=\'/resource/query\';'">设备列表</a></li>
				<li class="breadcrumb-item active" th:text="*{id > 0 ? '编辑设备' : '添加设备'}">添加设备</li>
			</ol>
			<!-- end breadcrumb -->
			<!-- begin page-header -->
			<h1 class="page-header" th:text="*{id > 0 ? '编辑设备' : '添加设备'}">设备信息<small></small></h1>
			<!-- end page-header -->
			<!-- <div class="panel panel-inverse">
				<div class="panel-heading">
					<div class="panel-heading-btn">
						
					</div>
					<h4 class="panel-title"><span class="hand" th:onclick="'location.href=\'/user/query\';'">用户列表</span>&nbsp;/&nbsp;新建用户</h4>
				</div>
			</div> -->
			
			<div class="row">
				<div class="col-lg-12">
					<div>
						<!-- 基本信息 -->
						<div class="panel panel-inverse">
							<div class="panel-heading">
								<div class="panel-heading-btn">
									
								</div>
								<h4 class="panel-title">基本信息</h4>
							</div>
							<div class="panel-body">
								<fieldset>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">设备名称</label>
										<div class="col-md-5">
											<input type="hidden" th:field="*{id}"/>
											<input type="hidden" th:field="*{serverList}">
											<input type="hidden" th:field="*{accountList}">
											<input name="name" id="name" type="text" class="form-control is-invalid" th:value="*{name}">
											<div class="invalid-feedback">请输入设备名称</div>
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">连接地址</label>
										<div class="col-md-5">
											<input name="ip" id="ip" type="text" class="form-control is-valid" th:value="*{ip}">
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">系统类型</label>
										<div class="col-md-5">
											<select id="type" name="type" class="form-control is-valid" data-style="btn-white">
												<option th:if="*{id eq 0}" value='Windows' selected="selected">Windows</option>
												<option th:if="*{id ne 0}" th:value="*{type}" selected="selected" th:text="*{type}"></option>
											</select>
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">系统版本</label>
										<div class="col-md-5">
											<select id="osType" name="osType" class="form-control is-valid" data-style="btn-white">
												<option th:if="*{id eq 0}" value='Windows XP' selected="selected">Windows XP</option>
												<option th:if="*{id ne 0}" th:value="*{osType}" selected="selected" th:text="*{osType}"></option>
											</select>
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">所属网络</label>
										<div class="col-md-5">
											<select id="networkId" name="networkId" class="form-control is-valid" data-style="btn-white">
												<option th:if="*{id eq 0}" value='0' selected="selected">请选择所属网络</option>
												<option th:if="*{id ne 0}" th:value="*{networkId}" selected="selected" th:text="*{networkName}"></option>
											</select>
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label">锁定状态</label>
										<div class="col-md-5">
											<select id="status" name="status" class="form-control is-valid">
												<option th:value="0" th:selected="*{status == 0}">锁定</option>
												<option th:value="1" th:selected="*{status == 1}">激活</option>
											</select>
										</div>
									</div>
									<div class="row form-group m-b-10">
										<label class="col-md-2 col-form-label"></label>
										<div class="col-md-5">
											<button type="button" class="btn btn-sm btn-primary m-r-5 data-submit">提交</button>
											<button type="button" class="btn btn-sm btn-default m-r-5" th:onclick="'location.href=\'/resource/query\';'">返回</button>
										</div>
									</div>
								</fieldset>
							</div>
						</div>
						<!-- 基本信息 END-->
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-12">
					<div>
						<!-- 服务配置信息 -->
						<div id="accordion" class="card-accordion">
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor collapsed" data-toggle="collapse" data-target="#collapseRdp">
									RDP
								</div>
								<div id="collapseRdp" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useRdp" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="rdpPort" id="rdpPort" type="text" class="form-control is-valid" value="3389">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: 0px">
															<i class="fas fa-lg fa-fw m-r-0 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: 0px">
															<i class="fas fa-lg fa-fw m-r-0 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor collapsed" data-toggle="collapse" data-target="#collapseTelnet">
									Telnet
								</div>
								<div id="collapseTelnet" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useTelnet" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="telnetPort" id="telnetPort" type="text" class="form-control is-valid" value="23">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account">
															<span class="tagit-label hand">Administrator</span><a class="tagit-close"><span class="text-icon">×</span><span class="ui-icon ui-icon-close"></span></a><input type="hidden" value="Tag1" name="tags" class="tagit-hidden-field">
														</li>
														<li class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account">
															<span class="tagit-label hand">Guest</span><a class="tagit-close"><span class="text-icon">×</span><span class="ui-icon ui-icon-close"></span></a><input type="hidden" value="Tag2" name="tags" class="tagit-hidden-field">
														</li>
														<li class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account">
															<span class="tagit-label hand">test</span><a class="tagit-close"><span class="text-icon">×</span><span class="ui-icon ui-icon-close"></span></a><input type="hidden" value="Tag1" name="tags" class="tagit-hidden-field">
														</li>
														<li class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account">
															<span class="tagit-label hand">good</span><a class="tagit-close"><span class="text-icon">×</span><span class="ui-icon ui-icon-close"></span></a><input type="hidden" value="Tag1" name="tags" class="tagit-hidden-field">
														</li>
														<li class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account">
															<span class="tagit-label hand">zhigongzhang</span><a class="tagit-close"><span class="text-icon">×</span><span class="ui-icon ui-icon-close"></span></a><input type="hidden" value="Tag2" name="tags" class="tagit-hidden-field">
														</li>
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor collapsed" data-toggle="collapse" data-target="#collapseSsh">
									SSH
								</div>
								<div id="collapseSsh" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useSsh" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="sshPort" id="sshPort" type="text" class="form-control is-valid" value="22">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor collapsed" data-toggle="collapse" data-target="#collapseSftp">
									SFTP
								</div>
								<div id="collapseSftp" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useSftp" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="sftpPort" id="sftpPort" type="text" class="form-control is-valid" value="22">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor" data-toggle="collapse" data-target="#collapseFTP">
									FTP
								</div>
								<div id="collapseFTP" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useFtp" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="ftpPort" id="ftpPort" type="text" class="form-control is-valid" value="21">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor" data-toggle="collapse" data-target="#collapseOracle">
									Oracle
								</div>
								<div id="collapseOracle" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useOracle" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="oraclePort" id="oraclePort" type="text" class="form-control is-valid" value="1521">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">数据库</label>
												<div class="col-md-5">
													<input name="oracleDb" id="oracleDb" type="text" class="form-control is-valid" value="orcl">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
							<!-- begin card -->
							<div class="card">
								<div class="card-header bg-black text-white pointer-cursor collapsed" data-toggle="collapse" data-target="#collapseSqlServer">
									SQLServer
								</div>
								<div id="collapseSqlServer" class="collapse panel-inverse" data-parent="#accordion">
									<div class="card-body panel-body">
										<fieldset>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">服务状态</label>
												<div class="col-md-5">
													<select id="useSqlServer" class="form-control is-valid">
														<option value="1">开启</option>
														<option value="0">关闭</option>
													</select>
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">端口</label>
												<div class="col-md-5">
													<input name="sqlServerPort" id="sqlServerPort" type="text" class="form-control is-valid" value="1433">
												</div>
											</div>
											<div class="row form-group m-b-10">
												<label class="col-md-2 col-form-label">账号</label>
												<div class="col-md-5">
													<ul id="jquery-tagIt-inverse" class="inverse tagit ui-widget ui-widget-content ui-corner-all">
														<li class="tagit-choice addAcc" style="margin-left: -2px">
															<i class="fas fa-lg fa-fw m-r-10 fa-plus-circle hand"></i>
														</li>
														<li class="tagit-choice delAllAcc" style="margin-left: -14px">
															<i class="fas fa-lg fa-fw m-r-10 fa-trash-alt hand"></i>
														</li>
													</ul>
												</div>
											</div>
										</fieldset>
									</div>
								</div>
							</div>
							<!-- end card -->
						</div>
					</div>
				</div>
			</div>
			</form>
		</div>
		<!-- end #content -->
		<!-- begin scroll to top btn -->
		<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
		<!-- end scroll to top btn -->
	</div>
	<!-- end page container -->
	
	<!-- #account-modal-dialog -->
	<div class="modal fade" id="account-modal-dialog">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">账号信息</h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				</div>
				<div class="modal-body account-body">
					<fieldset>
						<form id="accountForm">
						<div class="row form-group m-b-10">
							<label class="col-md-3 col-form-label">账号</label>
							<div class="col-md-9">
								<input type="hidden" name="serverID" id="serverID"/>
								<input name="accountName" id="accountName" type="text" class="form-control is-valid" value="">
							</div>
						</div>
						<div class="row form-group m-b-10">
							<label class="col-md-3 col-form-label">密码</label>
							<div class="col-md-9">
								<input name="accountPwd" id="accountPwd" type="password" class="form-control is-valid" value="">
							</div>
						</div>
						<div class="row form-group m-b-10">
							<label class="col-md-3 col-form-label">账号类型</label>
							<div class="col-md-9">
								<select style="width: 100%;" id="accountType" class="form-control is-valid">
									<option value="0">管理员</option>
									<option value="1">普通账号</option>
								</select>
							</div>
						</div>
						</form>
						<div class="row form-group m-b-10">
							<label class="col-md-3 col-form-label">所属服务</label>
							<div class="col-md-9">
								<div class="row">
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="rdpServer" type="checkbox" id="rdpServer"/>
											<label for="rdpServer">远程桌面服务</label>
										 </div>
									</div>
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="telnetServer" type="checkbox" id="telnetServer"/>
											<label for="telnetServer">Telnet 服务</label>
										 </div>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="sshServer" type="checkbox" id="sshServer"/>
											<label for="sshServer">SSH 服务</label>
										 </div>
									</div>
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="sftpServer" type="checkbox" id="sftpServer"/>
											<label for="sftpServer">SFTP 服务</label>
										 </div>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="oracleServer" type="checkbox" id="oracleServer"/>
											<label for="oracleServer">Oracle 服务</label>
										 </div>
									</div>
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="mssqlServer" type="checkbox" id="mssqlServer"/>
											<label for="mssqlServer">SQL Server 服务</label>
										 </div>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<div class="checkbox checkbox-css checkbox-inline">
											<input name="ftpServer" type="checkbox" id="ftpServer"/>
											<label for="ftpServer">FTP 服务</label>
										 </div>
									</div>
									<div class="col-md-6">
									</div>
								</div>
								<ul class="parsley-errors-list filled" id="parsley-id-multiple-mincheck">
									<li class="parsley-required">账号创建后将无法变更所属服务，如需变更请重新创建</li>
								</ul>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="modal-footer">
					<a href="javascript:;" class="btn btn-white" data-dismiss="modal">关闭</a>
					<a href="javascript:;" class="btn btn-primary">确定</a>
				</div>
			</div>
		</div>
	</div>
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../assets/plugins/jquery/jquery-3.3.1.min.js"></script>
	<script src="../assets/plugins/jquery/jquery-migrate-1.1.0.min.js"></script>
	<script src="../assets/plugins/jquery-ui/jquery-ui.min.js"></script>
	<script src="../assets/plugins/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
	<!--[if lt IE 9]>
		<script src="../assets/crossbrowserjs/html5shiv.js"></script>
		<script src="../assets/crossbrowserjs/respond.min.js"></script>
		<script src="../assets/crossbrowserjs/excanvas.min.js"></script>
	<![endif]-->
	<script src="../assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
	<script src="../assets/plugins/js-cookie/js.cookie.js"></script>
	<script src="../assets/js/theme/apple.min.js"></script>
	<script src="../assets/js/apps.min.js"></script>
	<!-- ================== END BASE JS ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL JS ================== -->
	<script src="../assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
	<script src="../assets/plugins/ionRangeSlider/js/ion-rangeSlider/ion.rangeSlider.min.js"></script>
	<script src="../assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
	<script src="../assets/plugins/masked-input/masked-input.min.js"></script>
	<script src="../assets/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
	<script src="../assets/plugins/password-indicator/js/password-indicator.js"></script>
	<script src="../assets/plugins/bootstrap-combobox/js/bootstrap-combobox.js"></script>
	<script src="../assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
	<script src="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
	<script src="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput-typeahead.js"></script>
	<script src="../assets/plugins/jquery-tag-it/js/tag-it.min.js"></script>
	<script src="../assets/plugins/bootstrap-daterangepicker/moment.js"></script>
	<script src="../assets/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
	<script src="../assets/plugins/select2/dist/js/select2.min.js"></script>
	<script src="../assets/plugins/bootstrap-eonasdan-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
	<script src="../assets/plugins/bootstrap-show-password/bootstrap-show-password.js"></script>
	<script src="../assets/plugins/bootstrap-colorpalette/js/bootstrap-colorpalette.js"></script>
	<script src="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker.js"></script>
	<script src="../assets/plugins/clipboard/clipboard.min.js"></script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	<script type="text/javascript" src="../javascript/custom/bugbycode.js"></script>
	<script type="text/javascript" src="../validator/validator.js"></script>
	<!-- 模态框  BEGIN-->
	<script src="../assets/plugins/gritter/js/jquery.gritter.js"></script>
	<script src="../assets/plugins/bootstrap-sweetalert/sweetalert.min.js"></script>
	<!-- 模态框  END-->
	<script>
		App.init();
	</script>
	<script type="text/javascript">
		$(document).ready(function(){
			function findAccount(account,useType){
				var acc = null;
				var accountArray = eval($("#accountList").val());
				for(var index = 0;index < accountArray.length;index++){
					var accObj = accountArray[index];
					var use = 0;
					if(useType == 0){
						use = accObj.useSsh;
					}else if(useType == 1){
						use = accObj.useSftp;
					}else if(useType == 2){
						use = accObj.useRdp;
					}else if(useType == 3){
						use = accObj.useTelnet;
					}else if(useType == 4){
						use = accObj.useOracle;
					}else if(useType == 5){
						use = accObj.useSqlServer;
					}else if(useType == 6){
						use = accObj.useFtp;
					}
					if(accObj.account == account && use == 1){
						acc = accObj;
						break;
					}
				}
				return acc;
			}
			
			function updateAccount(account,useType){
				var accountArray = eval($("#accountList").val());
				for(var index = 0;index < accountArray.length;index++){
					var accObj = accountArray[index];
					var use = 0;
					if(useType == 0){
						use = accObj.useSsh;
					}else if(useType == 1){
						use = accObj.useSftp;
					}else if(useType == 2){
						use = accObj.useRdp;
					}else if(useType == 3){
						use = accObj.useTelnet;
					}else if(useType == 4){
						use = accObj.useOracle;
					}else if(useType == 5){
						use = accObj.useSqlServer;
					}else if(useType == 6){
						use = accObj.useFtp;
					}
					if(accObj.account == account.account && use == 1){
						if(account.password != ''){
							accObj.password = account.password;
						}
						accObj.type = account.type;
						break;
					}
				}
				$("#accountList").val(JSON.stringify(accountArray));
			}
			
			function removeAccount(account,useType){
				var accountArray = eval($("#accountList").val());
				var newAccountArray = [];
				for(var index = 0;index < accountArray.length;index++){
					var accObj = accountArray[index];
					if(account == accObj.account){
						if(useType == 0){
							accObj.useSsh = 0;
						}else if(useType == 1){
							accObj.useSftp = 0;
						}else if(useType == 2){
							accObj.useRdp = 0;
						}else if(useType == 3){
							accObj.useTelnet = 0;
						}else if(useType == 4){
							accObj.useOracle = 0;
						}else if(useType == 5){
							accObj.useSqlServer = 0;
						}else if(useType == 6){
							accObj.useFtp = 0;
						}
						if(accObj.useSsh == 0 && accObj.useSftp == 0 && accObj.useRdp == 0 &&
								accObj.useTelnet == 0 && accObj.useOracle == 0 && accObj.useSqlServer == 0
								&& accObj.useFtp == 0){
							continue;
						}
					}
					newAccountArray.push(accObj);
				}
				$("#accountList").val(JSON.stringify(newAccountArray));
			}
			
			function addAccountToHtml(item){
				var accStr = "<li class=\"tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account\"><span class=\"tagit-label tagit-label-account hand\">";
				accStr += item.account;
				accStr += "</span><a class=\"tagit-close tagit-close-account\"><span class=\"text-icon\">×</span><span class=\"ui-icon ui-icon-close\"></span></a></li>";
				if(item.useSsh == 1){
					$("#sshPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useSftp == 1){
					$("#sftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useRdp == 1){
					$("#rdpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useTelnet == 1){
					$("#telnetPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useFtp == 1){
					$("#ftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useOracle == 1){
					$("#oraclePort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useSqlServer == 1){
					$("#sqlServerPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
			}
			
			$(".logout").click(function(){
				$("#logoutForm").submit();
			});
			$(".delAllAcc").click(function(e){
				var this_e = this;
				var serverID = $(this).parents(".panel-inverse").find("select").prop("id");
				e.preventDefault();
				swal({
					title: '您确定删除该服务下的所有账号吗？',
					text: '您执行该操作后该服务下的所有账号将会被删除，是否继续？',
					icon: 'warning',
					buttons: {
						cancel: {
							text: '取消',
							value: false,
							visible: true,
							className: 'btn btn-default',
							closeModal: true,
						},
						confirm: {
							text: '确定',
							value: true,
							visible: true,
							className: 'btn btn-warning',
							closeModal: true
						}
					}
				}).then(function(value){
					if(value == true){
						var useType = -1;
						if(serverID == 'useSsh'){
							useType = 0;
						}else if(serverID == 'useSftp'){
							useType = 1;
						}else if(serverID == 'useRdp'){
							useType = 2;
						}else if(serverID == 'useTelnet'){
							useType = 3;
						}else if(serverID == 'useOracle'){
							useType = 4;
						}else if(serverID == 'useSqlServer'){
							useType = 5;
						}else if(serverID == 'useFtp'){
							useType = 6;
						}
						if(useType > -1){
							$(this_e).parent().find(".tagit-account").each(function(index,item){
								var account = $(item).find(".tagit-label-account").text().trim();
								removeAccount(account,useType);
							});
							$(this_e).parent().find(".tagit-account").remove();
						}
					}
				});
			});
			
			function showMsgError(form,key,msg){
				$(form).find("#" + key).removeClass("is-valid");
				$(form).find("#" + key).removeClass("is-invalid");
				$(form).find("#" + key).addClass("is-invalid");
				$(form).find("#" + key).parent().find("div.invalid-feedback").remove();
				$(form).find("#" + key).after("<div class=\"invalid-feedback\">" + msg + "</div>");
			}
			
			function removeMsgError(form,key){
				$(form).find("#" + key).removeClass("is-valid");
				$(form).find("#" + key).addClass("is-valid");
				$(form).find("#" + key).removeClass("is-invalid");
				$(form).find("#" + key).parent().find("div.invalid-feedback").remove();
			}
			
			function checkAccountName(form,accountName){
				var reg = /^[A-Za-z0-9_\\@\\.]+$/
				var flag = true;
				if(accountName == ""){
					flag = false;
					showMsgError(form,"accountName","请输入账号");
				}else if(!reg.test(accountName)){
					flag = false;
					showMsgError(form,"accountName","账号格式错误，请输入字母、数字、下划线等普通字符");
				}else if(accountName.length > 50){
					flag = false;
					showMsgError(form,"accountName","账号格式错误，输入的内容不能超过五十个字符");
				}
				var readonly = $(form).find("#accountName").prop("readonly");
				if(!readonly){
					var useSqlServer = $("#account-modal-dialog").find("#mssqlServer").prop("checked") ? 1 : 0;
					var useOracle = $("#account-modal-dialog").find("#oracleServer").prop("checked") ? 1 : 0;
					var useFtp = $("#account-modal-dialog").find("#ftpServer").prop("checked") ? 1 : 0;
					var useTelnet = $("#account-modal-dialog").find("#telnetServer").prop("checked") ? 1 : 0;
					var useRdp = $("#account-modal-dialog").find("#rdpServer").prop("checked") ? 1 : 0;
					var useSsh = $("#account-modal-dialog").find("#sshServer").prop("checked") ? 1 : 0;
					var useSftp = $("#account-modal-dialog").find("#sftpServer").prop("checked") ? 1 : 0;
					if(useSsh == 1 && flag){
						var acc = findAccount(accountName,0);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","SSH服务已存在该账号");
						}
					}
					if(useSftp == 1 && flag){
						var acc = findAccount(accountName,1);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","SFTP服务已存在该账号");
						}
					}
					if(useRdp == 1 && flag){
						var acc = findAccount(accountName,2);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","远程桌面服务已存在该账号");
						}
					}
					if(useTelnet == 1 && flag){
						var acc = findAccount(accountName,3);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","Telnet服务已存在该账号");
						}
					}
					if(useOracle == 1 && flag){
						var acc = findAccount(accountName,4);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","Oracle服务已存在该账号");
						}
					}
					if(useSqlServer == 1 && flag){
						var acc = findAccount(accountName,5);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","SQLSERVER服务已存在该账号");
						}
					}
					if(useFtp == 1 && flag){
						var acc = findAccount(accountName,6);
						if(acc != null){
							flag = false;
							showMsgError(form,"accountName","FTP服务已存在该账号");
						}
					}
				}
				if(flag){
					removeMsgError(form,"accountName");
				}
				return flag;
			}
			
			function checkPassword(form,password){
				var flag = true;
				if(password.length > 20){
					flag = false;
					showMsgError(form,"accountPwd","密码不能超过二十个字符");
				}else{
					removeMsgError(form,"accountPwd");
				}
				return flag;
			}
			
			$("#accountForm").find("#accountName").bind({
				"blur":function(){
					checkAccountName("#accountForm",$(this).val());
				},"change":function(){
					checkAccountName("#accountForm",$(this).val());
				},"keyup":function(){
					checkAccountName("#accountForm",$(this).val());
				}
			});
			
			$("#accountForm").find("#accountPwd").bind({
				"blur":function(){
					checkPassword("#accountForm",$(this).val());
				},"change":function(){
					checkPassword("#accountForm",$(this).val());
				},"keyup":function(){
					checkPassword("#accountForm",$(this).val());
				}
			});
			
			$("#account-modal-dialog .btn-primary").click(function(){
				var form = "#accountForm";
				var accountName = $(form).find("#accountName").val();
				var accountPwd = $(form).find("#accountPwd").val();
				var serverID = $("#serverID").val();
				var accountArray = eval($("#accountList").val());
				var type = $("#account-modal-dialog").find("#accountType option:selected").val();
				var readonly = $(form).find("#accountName").prop("readonly");//只读情况下为编辑模式
				if(checkAccountName(form,accountName) && checkPassword(form,accountPwd)){
					var account = {
						account : accountName,
						password : accountPwd,
						type : type
					};
					account.useSqlServer = $("#account-modal-dialog").find("#mssqlServer").prop("checked") ? 1 : 0;
					account.useOracle = $("#account-modal-dialog").find("#oracleServer").prop("checked") ? 1 : 0;
					account.useFtp = $("#account-modal-dialog").find("#ftpServer").prop("checked") ? 1 : 0;
					account.useTelnet = $("#account-modal-dialog").find("#telnetServer").prop("checked") ? 1 : 0;
					account.useRdp = $("#account-modal-dialog").find("#rdpServer").prop("checked") ? 1 : 0;
					account.useSsh = $("#account-modal-dialog").find("#sshServer").prop("checked") ? 1 : 0;
					account.useSftp = $("#account-modal-dialog").find("#sftpServer").prop("checked") ? 1 : 0;
					if(readonly){
						var acc = null;
						var useType = -1;
						if(serverID == 'useSsh'){
							acc = findAccount(accountName,0);
							useType = 0;
						}else if(serverID == 'useSftp'){
							acc = findAccount(accountName,1);
							useType = 1;
						}else if(serverID == 'useRdp'){
							acc = findAccount(accountName,2);
							useType = 2;
						}else if(serverID == 'useTelnet'){
							acc = findAccount(accountName,3);
							useType = 3;
						}else if(serverID == 'useOracle'){
							acc = findAccount(accountName,4);
							useType = 4;
						}else if(serverID == 'useSqlServer'){
							acc = findAccount(accountName,5);
							useType = 5;
						}else if(serverID == 'useFtp'){
							acc = findAccount(accountName,6);
							useType = 6;
						}
						if(acc == null){
							alert('账号异常');
							return false;
						}
						acc.password = accountPwd;
						acc.type = type;
						if(useType > -1){
							updateAccount(acc,useType);
						}
					}else{
						accountArray.push(account);
						addAccountToHtml(account);
						$("#accountList").val(JSON.stringify(accountArray));
					}
					$("#account-modal-dialog").modal("hide");
				}
			});
			
			$("#sshPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#sftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#rdpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#ftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#telnetPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#oraclePort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();
			$("#sqlServerPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".tagit-account").remove();

			function uncheckServer(){
				$("#account-modal-dialog").find("#accountType").find("option[value=\"1\"]").prop("selected",true);
				$("#account-modal-dialog").find("#accountType").find("option[value=\"0\"]").prop("selected",false);
				removeMsgError("#accountForm","accountName");
				removeMsgError("#accountForm","accountPwd");
				$("#account-modal-dialog").find("#mssqlServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#mssqlServer").prop("checked",false);
				$("#account-modal-dialog").find("#oracleServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#oracleServer").prop("checked",false);
				$("#account-modal-dialog").find("#ftpServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#ftpServer").prop("checked",false);
				$("#account-modal-dialog").find("#telnetServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#telnetServer").prop("checked",false);
				$("#account-modal-dialog").find("#rdpServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#rdpServer").prop("checked",false);
				$("#account-modal-dialog").find("#sshServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#sshServer").prop("checked",false);
				$("#account-modal-dialog").find("#sftpServer").parent().find("label").prop("for","");
				$("#account-modal-dialog").find("#sftpServer").prop("checked",false);
			}
			function checkServer(item){
				uncheckServer();
				
				$("#account-modal-dialog").find("#mssqlServer").prop("checked",item.useSqlServer == 1);
				$("#account-modal-dialog").find("#oracleServer").prop("checked",item.useOracle == 1);
				$("#account-modal-dialog").find("#ftpServer").prop("checked",item.useFtp == 1);
				$("#account-modal-dialog").find("#telnetServer").prop("checked",item.useTelnet == 1);
				$("#account-modal-dialog").find("#rdpServer").prop("checked",item.useRdp == 1);
				$("#account-modal-dialog").find("#sshServer").prop("checked",item.useSsh == 1);
				$("#account-modal-dialog").find("#sftpServer").prop("checked",item.useSftp == 1);
			}
			
			$(document).on('click','.tagit-label-account',function(e){
				$("#account-modal-dialog").modal("show");
				$("#account-modal-dialog").find("#accountName").prop("readonly",true);
				var serverID = $(this).parents(".panel-inverse").find("select").prop("id");
				var account = $(this).text().trim();
				$("#account-modal-dialog").find("#accountName").val(account);
				$("#account-modal-dialog").find("#accountPwd").val("");
				var accountArray = eval($("#accountList").val());
				$("#serverID").val(serverID);
				$(accountArray).each(function(index,item){
					if(account == item.account && serverID == "useSsh" && item.useSsh == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useFtp" && item.useFtp == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useSftp" && item.useSftp == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useRdp" && item.useRdp == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useTelnet" && item.useTelnet == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useOracle" && item.useOracle == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}else if(account == item.account && serverID == "useSqlServer" && item.useSqlServer == 1){
						checkServer(item);
						$("#account-modal-dialog").find("#accountType").find("option[value=\"" + item.type +"\"]").prop("selected",true);
					}
				});
			});
			
			$(".addAcc").click(function(){
				uncheckServer();
				
				$("#account-modal-dialog").find("#mssqlServer").parent().find("label").prop("for","mssqlServer");
				$("#account-modal-dialog").find("#oracleServer").parent().find("label").prop("for","oracleServer");
				$("#account-modal-dialog").find("#ftpServer").parent().find("label").prop("for","ftpServer");
				$("#account-modal-dialog").find("#telnetServer").parent().find("label").prop("for","telnetServer");
				$("#account-modal-dialog").find("#rdpServer").parent().find("label").prop("for","rdpServer");
				$("#account-modal-dialog").find("#sshServer").parent().find("label").prop("for","sshServer");
				$("#account-modal-dialog").find("#sftpServer").parent().find("label").prop("for","sftpServer");
				
				
				$("#account-modal-dialog").modal("show");
				$("#account-modal-dialog").find("#accountName").prop("readonly",false);
				var serverID = $(this).parents(".panel-inverse").find("select").prop("id");
				$("#serverID").val(serverID);
				$("#account-modal-dialog").find("#accountName").val("");
				$("#account-modal-dialog").find("#accountPwd").val("");
				if(serverID == 'useRdp'){
					$("#account-modal-dialog").find("#rdpServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#rdpServer").prop("checked",true);
				}else if(serverID == 'useSqlServer'){
					$("#account-modal-dialog").find("#mssqlServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#mssqlServer").prop("checked",true);
				}else if(serverID == 'useOracle'){
					$("#account-modal-dialog").find("#oracleServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#oracleServer").prop("checked",true);
				}else if(serverID == 'useFtp'){
					$("#account-modal-dialog").find("#ftpServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#ftpServer").prop("checked",true);
				}else if(serverID == 'useTelnet'){
					$("#account-modal-dialog").find("#telnetServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#telnetServer").prop("checked",true);
				}else if(serverID == 'useSsh'){
					$("#account-modal-dialog").find("#sshServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#sshServer").prop("checked",true);
				}else if(serverID == 'useSftp'){
					$("#account-modal-dialog").find("#sftpServer").parent().find("label").prop("for","");
					$("#account-modal-dialog").find("#sftpServer").prop("checked",true);
				}
			});
			
			$(document).on('click',".tagit-close-account",function(e){
				var this_e = this;
				var serverID = $(this).parents(".panel-inverse").find("select").prop("id");
				var account = $(this).prev().text().trim();
				e.preventDefault();
				swal({
					title: '您确定删除所选的账号吗？',
					text: '您执行该操作后账号将从对应的服务中删除，是否继续？',
					icon: 'warning',
					buttons: {
						cancel: {
							text: '取消',
							value: false,
							visible: true,
							className: 'btn btn-default',
							closeModal: true,
						},
						confirm: {
							text: '确定',
							value: true,
							visible: true,
							className: 'btn btn-warning',
							closeModal: true
						}
					}
				}).then(function(value){
					if(value == true){
						var useType = -1;
						if(serverID == 'useSsh'){
							useType = 0;
						}else if(serverID == 'useSftp'){
							useType = 1;
						}else if(serverID == 'useRdp'){
							useType = 2;
						}else if(serverID == 'useTelnet'){
							useType = 3;
						}else if(serverID == 'useOracle'){
							useType = 4;
						}else if(serverID == 'useSqlServer'){
							useType = 5;
						}else if(serverID == 'useFtp'){
							useType = 6;
						}
						if(useType > -1){
							removeAccount(account,useType);
							$(this_e).parent().remove();
						}
					}
				});
			});
			var serverArray = eval($("#serverList").val());
			var accountArray = eval($("#accountList").val());
			$(serverArray).each(function(index,item){
				var serverType = item.serverType;
				var port = item.port;
				var use = item.use;
				var dbName = item.dbName;
				if(serverType == 0){
					$("#sshPort").val(port);
					$("#useSsh").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 1){
					$("#sftpPort").val(port);
					$("#useSftp").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 2){
					$("#rdpPort").val(port);
					$("#useRdp").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 3){
					$("#telnetPort").val(port);
					$("#useTelnet").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 4){
					$("#oraclePort").val(port);
					$("#oracleDb").val(dbName);
					$("#useOracle").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 5){
					$("#sqlServerPort").val(port);
					$("#useSqlServer").find("option[value='" + use + "']").prop("selected",true);
				}else if(serverType == 6){
					$("#ftpPort").val(port);
					$("#useFtp").find("option[value='" + use + "']").prop("selected",true);
				}
			});
			$(accountArray).each(function(index,item){
				var accStr = "<li class=\"tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable tagit-account\"><span class=\"tagit-label tagit-label-account hand\">";
				accStr += item.account;
				accStr += "</span><a class=\"tagit-close tagit-close-account\"><span class=\"text-icon\">×</span><span class=\"ui-icon ui-icon-close\"></span></a></li>";
				if(item.useSsh == 1){
					$("#sshPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useSftp == 1){
					$("#sftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useRdp == 1){
					$("#rdpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useTelnet == 1){
					$("#telnetPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useFtp == 1){
					$("#ftpPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useOracle == 1){
					$("#oraclePort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
				if(item.useSqlServer == 1){
					$("#sqlServerPort").parents("fieldset").find("#jquery-tagIt-inverse").find(".addAcc").before(accStr);
				}
			});
		});
		
		$.addValidator('checkResName',function(element,value){
			var flag = true;
			$.ajaxSettings.async = false;
			$.get("/resource/checkResName",{resName:value},function(data){
				var resId = data.id;
				var id = $("#id").val();
				flag = (resId == 0 || resId == id);
			});
			return flag;
		});
		
		$.addValidator('checkPort',function(element,value){
			var reg = /^[0-9]+$/
			if(!reg.test(value)){
				return false;
			}
			if(!(value > -1 && value < 65536)){
				return false;
			}
			return true;
		});
		
		var rules = {
			name:{
				required:true,
				min:2,
				max:20,
				resName:true,
				checkResName:true
			},ip:{
				required:true
			},rdpPort:{
				required:true,
				checkPort:true
			},sshPort:{
				required:true,
				checkPort:true
			},sftpPort:{
				required:true,
				checkPort:true
			},ftpPort:{
				required:true,
				checkPort:true
			},telnetPort:{
				required:true,
				checkPort:true
			},oraclePort:{
				required:true,
				checkPort:true
			},sqlServerPort:{
				required:true,
				checkPort:true
			},oracleDb:{
				max:30
			}
		};
		
		var messages = {
			name:{
				required:"请输入设备名称",
				min:"设备名称至少由两个字符组成",
				max:"设备名称不能超过二十个字符",
				resName:"设备名称格式错误，请输入中文、字母、数字以及下划线等普通字符",
				checkResName:"该资产名称已存在"
			},ip:{
				required:"请输入设备连接地址"
			},rdpPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},sshPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},sftpPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},ftpPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},telnetPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},oraclePort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},sqlServerPort:{
				required:"请输入端口号",
				checkPort:"请输入0~65535之间的数字"
			},oracleDb:{
				max:"数据库名不能超过三十个字符"
			}
		};
		
		var type = [
			{id:'Windows',text:'Windows'},
			{id:'Linux',text:'Linux'}
		];
		
		var osType = {
			Windows:[
				{id:'Windows XP',text:'Windows XP'},
				{id:'Windows 7',text:'Windows 7'}
			],
			Linux:[
				{id:'Debian',text:'Debian'},
				{id:'CentOs',text:'CentOs'}
			]
		};
		var osName = $("#type").val();
		var os = osType[osName];
		$("#type").select2({width:'100%',data:type});
		$("#type").bind({'change':function(){
				osName = $(this).val();
				os = osType[osName];
				$("#osType").find("option").remove();
				$("#osType").select2({width:'100%',data:os});
			}
		});
		$("#osType").select2({width:'100%',data:os});
		
		function select2Format(selector,url,defaultText){
			$(selector).select2({
				width:'100%',
				ajax:{
		    		type:"get",
		    		url: function (params) {
	    				var value = params.term;
	    				if(value == undefined){
	    					value = "";
	    				}
	    		      	return url + value;
	    		    },processResults:function(data,params){
	    		    	var list = data.list;
	    		    	var result = [{id:0,text:defaultText}];
	    		    	$.each(list,function(index,item){
	    		    		result.push({
	    		    			id:item.id,
	    		    			text:item.name
	    		    		});
	    		    	});
	    		    	var rs = {
	   		    			results:result
	    		    	};
	    		    	return rs;
	    		    }
		    	}
			});
		}
		select2Format("#networkId","/resource/queryNetwork?name=","请选择所属网络");
		$.validator("#resForm");
		$(".data-submit").click(function(){
			var server = [
				{
					serverType:0,
					port:$("#sshPort").val(),
					use:$("#useSsh").val()
				},{
					serverType:1,
					port:$("#sftpPort").val(),
					use:$("#useSftp").val()
				},{
					serverType:2,
					port:$("#rdpPort").val(),
					use:$("#useRdp").val()
				},{
					serverType:3,
					port:$("#telnetPort").val(),
					use:$("#useTelnet").val()
				},{
					serverType:4,
					port:$("#oraclePort").val(),
					use:$("#useOracle").val(),
					dbName:$("#oracleDb").val()
				},{
					serverType:5,
					port:$("#sqlServerPort").val(),
					use:$("#useSqlServer").val()
				},{
					serverType:6,
					port:$("#ftpPort").val(),
					use:$("#useFtp").val()
				}
			];
			$("#serverList").val(JSON.stringify(server));
			$("#resForm").submit();
		});
		//$.validator("#accountForm");
	</script>
</body>
</html>