<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<!--<![endif]-->
<head>
	<meta charset="utf-8" />
	<meta th:include="pages/layout/title :: title"></meta>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	
	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
	<link href="../assets/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" />
	<link href="../assets/plugins/font-awesome/5.3/css/all.min.css" rel="stylesheet" />
	<link href="../assets/plugins/ionicons/css/ionicons.min.css" rel="stylesheet" />
	<link href="../assets/plugins/animate/animate.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/style.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/style-responsive.min.css" rel="stylesheet" />
	<link href="../assets/css/apple/theme/default.css" rel="stylesheet" id="theme" />
	<!-- ================== END BASE CSS STYLE ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL STYLE ================== -->
	<link href="../assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.css" rel="stylesheet" />
	<link href="../assets/plugins/ionRangeSlider/css/ion.rangeSlider.css" rel="stylesheet" />
	<link href="../assets/plugins/ionRangeSlider/css/ion.rangeSlider.skinNice.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/password-indicator/css/password-indicator.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-combobox/css/bootstrap-combobox.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-tag-it/css/jquery.tagit.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet" />
	<link href="../assets/plugins/select2/dist/css/select2.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-eonasdan-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
	<link href="../assets/plugins/bootstrap-colorpalette/css/bootstrap-colorpalette.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker-fontawesome.css" rel="stylesheet" />
	<link href="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker-glyphicons.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL STYLE ================== -->
	<link href="../assets/plugins/gritter/css/jquery.gritter.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../assets/plugins/pace/pace.min.js"></script>
	<!-- ================== END BASE JS ================== -->
	<style type="text/css">
		.dataTables_filter{
			text-align: right;
		}
		.hand{
			cursor: pointer;
		}
		.cssCheckboxAll{
			margin-top: -24px;
		}
		
		.tdLineHeight{
			line-height: 30px;
		}
	</style>
</head>
<body>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show"><span class="spinner"></span></div>
	<!-- end #page-loader -->
	
	<!-- begin #page-container -->
	<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
		<!-- begin #header -->
		<div th:include="pages/layout/head :: head"></div>
		<!-- end #header -->
		
		<!-- 左侧菜单 -->
		<div th:include="pages/layout/left :: left('sso','sso')"></div>
		
		<!-- begin #content -->
		<div id="content" class="content">
			<ol class="breadcrumb pull-right">
				<li class="breadcrumb-item"><a href="javascript:;" th:onclick="'location.href=\'/resource/query\';'">设备信息</a></li>
				<li class="breadcrumb-item active">设备列表</li>
			</ol>
			<h1 class="page-header">设备列表<small></small></h1>
			<div class="panel panel-inverse">
				<div class="panel-heading">
					<div class="panel-heading-btn">
						
					</div>
					<h4 class="panel-title">设备列表</h4>
				</div>
				<div class="panel-body">
					<form th:action="@{/sso/query}" method="get" autocomplete="off">
					<div class="dataTables_wrapper form-inline dt-bootstrap no-footer">
						<div class="row">
							<div class="col-sm-12">
								<div class="dataTables_filter">
									<label>
										<input type="text" name="paramQuery" th:value="${paramQuery}" class="form-control input-sm" placeholder="请输入查询条件" aria-controls="data-table-default">
										<i class="ion-ios-search fa-2x fa-fw pull-right m-r-0 text-black-lighter hand"></i>
									</label>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-12 table-responsive">
								<table id="data-table-default" class="table table-striped table-bordered dataTable no-footer dtr-inline table-hover">
									<thead>
										<tr>
											<th width="1%">
												<div class="checkbox checkbox-css cssCheckboxAll hand">
			                                         <input type="checkbox" id="cssCheckboxAll" />
			                                         <label class="hand" for="cssCheckboxAll"></label>
			                                     </div>
											</th>
											<th class="text-nowrap">设备名称</th>
											<th class="text-nowrap">访问地址</th>
											<th class="text-nowrap">系统类型</th>
											<th class="text-nowrap">系统版本</th>
											<th class="text-nowrap">所属网络</th>
											<th class="text-nowrap">登录账号</th>
											<th class="text-nowrap">操作</th>
										</tr>
									</thead>
									<tbody>
										<tr class="gradeA odd" th:if="${#lists.isEmpty(list)}">
											<td colspan="11" style="text-align: center;">没有查询到匹配的信息</td>
										</tr>
										<tr class="odd gradeA tdLineHeight" th:each="r:${list}">
											<td>
												<div class="checkbox checkbox-css cssTabCheckBox">
			                                         <input type="checkbox" name="deviceIds" th:id="${'cssCheckbox' + r.deviceId}" th:value="${r.deviceId}" />
			                                         <label class="hand" th:for="${'cssCheckbox' + r.deviceId}"></label>
			                                     </div>
											</td>
											<td th:text="${r.deviceName}"></td>
											<td th:text="${r.deviceIp}"></td>
											<td th:text="${r.deviceType}"></td>
											<td th:text="${r.deviceOs}"></td>
											<td th:text="${r.networkName}"></td>
											<td>
												<select class="form-control" data-style="btn-white">
													<option th:each="acc:${r.accountList}" th:text="${acc}"></option>
												</select>
											</td>
											<td>
												<a href="javascript:;" class="btn btn-icon connDevice" title="连接设备">
													<i class="ion-ios-flash fa-2x text-black-lighter"></i>
												</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<div th:include="pages/commons/page :: page"></div>
						</div>
					</div>
					</form>
					<form id="deleteForm" th:action="@{/resource/delete}" method="post">
						<input type="hidden" name="ids" />
					</form>
				</div>
			</div>
		</div>
		<!-- end #content -->
		<!-- begin scroll to top btn -->
		<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
		<!-- end scroll to top btn -->
	</div>
	<!-- end page container -->
	
	<!-- #res-modal-dialog -->
	<div class="modal fade" id="auth-modal-dialog">
		<div class="modal-dialog modal-md">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">认证信息</h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				</div>
				<div class="modal-body">
					<div class="row ">
						<div class="col-md-12">
							<p>
							当前系统已为您分配临时数据库实例，认证信息分别如下：<br/>
							Username：<span th:text="${session.SPRING_SECURITY_CONTEXT.authentication.principal.username}"></span><br/>
							Password：您登录web应用所使用的密码<br/>
							Database：<span id="database"></span>
							<br/><br/>
							请将以上信息依次填写到如下图所示的Oracle数据库客户端中。<br/>
							<span style="color: red">注：以上临时分配的数据库实例将在每天凌晨自动删除。</span>
							</p>
						</div>
					</div>
					<div class="row ">
						<div class="col-md-12">
							<img alt="" th:src="@{/images/sso/sso_module.png}">
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<a href="javascript:;" class="btn btn-white" data-dismiss="modal">关闭</a>
				</div>
			</div>
		</div>
	</div>
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="../assets/plugins/jquery/jquery-3.3.1.min.js"></script>
	<script src="../assets/plugins/jquery/jquery-migrate-1.1.0.min.js"></script>
	<script src="../assets/plugins/jquery-ui/jquery-ui.min.js"></script>
	<script src="../assets/plugins/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
	<!--[if lt IE 9]>
		<script src="../assets/crossbrowserjs/html5shiv.js"></script>
		<script src="../assets/crossbrowserjs/respond.min.js"></script>
		<script src="../assets/crossbrowserjs/excanvas.min.js"></script>
	<![endif]-->
	<script src="../assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
	<script src="../assets/plugins/js-cookie/js.cookie.js"></script>
	<script src="../assets/js/theme/apple.min.js"></script>
	<script src="../assets/js/apps.min.js"></script>
	<!-- ================== END BASE JS ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL JS ================== -->
	<script src="../assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
	<script src="../assets/plugins/ionRangeSlider/js/ion-rangeSlider/ion.rangeSlider.min.js"></script>
	<script src="../assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
	<script src="../assets/plugins/masked-input/masked-input.min.js"></script>
	<script src="../assets/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
	<script src="../assets/plugins/password-indicator/js/password-indicator.js"></script>
	<script src="../assets/plugins/bootstrap-combobox/js/bootstrap-combobox.js"></script>
	<script src="../assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
	<script src="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
	<script src="../assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput-typeahead.js"></script>
	<script src="../assets/plugins/jquery-tag-it/js/tag-it.min.js"></script>
	<script src="../assets/plugins/bootstrap-daterangepicker/moment.js"></script>
	<script src="../assets/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
	<script src="../assets/plugins/select2/dist/js/select2.min.js"></script>
	<script src="../assets/plugins/bootstrap-eonasdan-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
	<script src="../assets/plugins/bootstrap-show-password/bootstrap-show-password.js"></script>
	<script src="../assets/plugins/bootstrap-colorpalette/js/bootstrap-colorpalette.js"></script>
	<script src="../assets/plugins/jquery-simplecolorpicker/jquery.simplecolorpicker.js"></script>
	<script src="../assets/plugins/clipboard/clipboard.min.js"></script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	<!-- 模态框  BEGIN-->
	<script src="../assets/plugins/gritter/js/jquery.gritter.js"></script>
	<script src="../assets/plugins/bootstrap-sweetalert/sweetalert.min.js"></script>
	<!-- 模态框  END-->
	<script type="text/javascript" src="../javascript/custom/bugbycode.js"></script>
	
	<script>
		$(document).ready(function() {
			App.init();
		});
	</script>
	<script type="text/javascript">
		$("input[name='paramQuery']").keypress(function(event){
			if(event.keyCode == 13){
				query();
			}
		});
		$(".ion-ios-search").click(function(){
			query();
		});
		$(".logout").click(function(){
			$("#logoutForm").submit();
		});
		$("#cssCheckboxAll").click(function(){
			if($(this).prop("checked")){
				$("div.checkbox").find("input").prop("checked",true);
			}else{
				$("div.checkbox").find("input").prop("checked",false);
			}
		});
		
		$(".connDevice").click(function(){
			var account = $(this).parent().prevAll().eq(0).find("select").val();
			var deviceId = $(this).parent().prevAll().eq(6).find("input[name='deviceIds']").val();
			$.ajax({
				url:'/sso/createSession',
				type:'get',
				data:'deviceId=' + deviceId + '&account=' + account,
				dataType:'json',
				cache:false,
				success:function(result){
					$("#database").text(location.hostname + ":1521/" + result.database)
					$("#auth-modal-dialog").modal("show");
				}
			});
		});
	</script>
</body>
</html>